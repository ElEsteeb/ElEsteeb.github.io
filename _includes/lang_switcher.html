<nav class="language-switcher">
  {% assign current_lang = page.lang | default: site.default_lang %}


  {% for lang in site.languages %}
    {% if lang == current_lang %}
      <span class="active-lang">{{ lang | upcase }}</span>
    {% else %}
      {% comment %}
        Determine the target URL to the other language's index page.
        If switching TO the default language (e.g., from ES to EN), go to site root '/'.
        If switching TO another language (e.g., from EN to ES), go to '/lang/'.
      {% endcomment %}
      {% assign target_url = "" %}
      {% if lang == site.default_lang %}
        {% assign target_url = '/' %}
      {% else %}
        {% assign target_url = '/' | append: lang | append: '/' %}
      {% endif %}

      <a href="{{ target_url | relative_url }}">{{ lang | upcase }}</a>
    {% endif %}
  {% endfor %}
</nav>